 
#Adriano Barbieri			8921162
#Douglas Mizuma				8920964
#Laura Castro Vieira			8598822
#VirgÃ­lio Fernandes Junior	7640870
 
#Artefato 3 - A

#Consulta 1:
 
SELECT VO.voo_codigo AS Voo, A.numero AS Assento
FROM Passagem PAS
JOIN Passageiro PSG ON PAS.psg_codigo = PSG.psg_codigo
JOIN Voo VO ON VO.voo_codigo=PAS.voo_codigo, Assento A
WHERE A.ass_codigo = PAS.ass_codigo
AND PSG.documento = '86554081456';
 
#Consulta 2:
 
SELECT C.nome, COUNT(A.aer_codigo) AS Quantidade_Aeronaves
FROM companhia C, aeronave A
WHERE C.com_codigo = A.com_companhia
GROUP BY C.com_codigo;
 
#Consulta 3:
 
SELECT COUNT(PAS.psg_codigo) AS num_pas
FROM passagem PAS
WHERE PAS.voo_codigo = 60;
 
#Consulta 4:
 
SELECT CO.nome, COUNT(VO.voo_codigo) AS QTD_VOOS
FROM Voo AS VO, Aeronave AE, Companhia CO
WHERE CO.com_codigo = AE.com_companhia
AND AE.aer_codigo = VO.aer_codigo
AND VO.data_hora_ini >='2000-01-01'
AND VO.data_hora_ini < '2000-12-31'
GROUP BY CO.com_codigo;


#Artefato 3 - B


Consulta 1:
select VO.voo_codigo as Voo, A.numero AS assento
from Voo VO
JOIN passagem PAS ON VO.voo_codigo = PAS.voo_codigo
JOIN passageiro PSG ON PSG.psg_codigo = PAS.psg_codigo, Assento A
where A.ass_codigo = PAS.ass_codigo AND PSG.documento = '86554081456';

SELECT VO.voo_codigo AS Voo, A.numero AS Assento
FROM Passagem PAS
JOIN Passageiro PSG ON PAS.psg_codigo = PSG.psg_codigo
JOIN Voo VO ON VO.voo_codigo=PAS.voo_codigo, Assento A
WHERE A.ass_codigo = PAS.ass_codigo;

#Consulta 2:
 
SELECT C.nome, COUNT(A.aer_codigo) AS Quantidade_Aeronaves
FROM aeronave A, companhia C
WHERE C.com_codigo = A.com_companhia AND A.qtd_assentos > 60
GROUP BY C.com_codigo;
 
SELECT C.nome, COUNT(A.aer_codigo) AS Quantidade_Aeronaves
FROM aeronave A, companhia C
WHERE C.com_codigo = A.com_companhia AND A.qtd_assentos > 60 AND C.nome LIKE '%x%'
GROUP BY C.com_codigo;

#Consulta 3:
 
select count(PAS.psg_codigo) as num_pas
from passagem PAS
group by PAS.voo_codigo;

select count(PAS.psg_codigo) as num_pas, PAS.voo_codigo
from passagem PAS
where PAS.voo_codigo > 17000
group by PAS.voo_codigo;

#Consulta 4:
 
SELECT CO.nome, COUNT(VO.voo_codigo) AS QTD_VOOS
FROM Voo AS VO, Aeronave AE, Companhia CO
WHERE CO.com_codigo = AE.com_companhia
AND AE.aer_codigo = VO.aer_codigo
AND VO.data_hora_ini >='2000-01-01'
AND VO.data_hora_ini < '2000-12-31'
AND CO.com_codigo = 7;

SELECT CO.nome, CO.com_codigo, COUNT(VO.voo_codigo) AS QTD_VOOS
FROM Voo AS VO, Aeronave AE, Companhia CO
WHERE CO.com_codigo = AE.com_companhia
AND AE.aer_codigo = VO.aer_codigo
GROUP BY CO.com_codigo;

#Artefato 3 - C
 
SELECT V.voo_codigo AS voo, A.numero AS Assento
FROM passageiro PSG, assento A, voo V, passagem PAS
WHERE PAS.psg_codigo = PSG.psg_codigo AND A.ass_codigo = PAS.ass_codigo AND V.voo_codigo = PAS.voo_codigo AND PSG.documento = '86554081456';
 
select V.voo_codigo AS voo, A.numero AS assento
from (passagem PAS JOIN passageiro PSG ON PAS.psg_codigo = PSG.psg_codigo), voo V, assento A
where A.ass_codigo = PAS.ass_codigo AND V.voo_codigo = PAS.voo_codigo AND PSG.documento = '86554081456'; 
 
#Artefato 3 - D
 
select CO.nome, COUNT(V.voo_codigo) AS QTD_VOOS
FROM Aeronave AE, Companhia CO, (select V.aer_codigo, V.voo_codigo from voo V where V.data_hora_ini >= '2000-01-01' AND V.data_hora_ini < '2000-12-31') V
WHERE AE.aer_codigo = V.voo_codigo AND CO.com_codigo = AE.com_companhia
GROUP BY CO.com_codigo;
